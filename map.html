<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Add icon library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <style>


div.transbox {
  margin: 30px;
  background-color: #ffffff;
  border: 1px solid black;
  opacity: 0.6;
}

div.transbox p {
  margin: 5%;
  font-weight: bold;
  color: #000000;
}

.btn {
  background-color: DodgerBlue;
  border: none;
  color: white;
  padding: 12px 16px;
  font-size: 16px;
  cursor: pointer;
}
.float-button {
position: fixed;
right: -77px;
top: 270px;
transition: all 0.2s ease-in 0s;
z-index: 9999;
cursor: pointer;
}
.float-button:hover {
right: -7px;
}

/* Darker background on mouse-over */
.btn:hover {
  background-color: RoyalBlue;
}



    </style>
    <body>
<center>

        <ul>
  
            <a href="index.html" <button class="btn"> <i class="fa fa-home"> </i> Home</button></a>
            <a href="download.html" <button class="btn"> <i class="fa fa-download"> </i> Download Data</button></a>
            <a href="visualization.html" <button class="btn"> <i class="fa fa-bar-chart"> </i> Visualization</button></a>
            <a href="map.html" <button class="btn"> <i class="fa fa-bar-chart"> </i> Map </button></a>

      
    </ul>

</center>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Census-Map</title>
    <link rel="stylesheet" href="https://spin.js.org/spin.css"/>
    <script src="https://spin.js.org/spin.umd.js"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
     
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css"
    integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"
    integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ=="
    crossorigin=""></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.2/font/bootstrap-icons.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>

    <style>
       body {
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  margin: 0;
  overflow: hidden;
}
.full-height {
  height: 100%;
}

.header {
    height: 50px;
}

.leaflet-popup-content-wrapper {
    background: rgba(0, 0, 0, 0.9);
    color: #ffffff;
}

.leaflet-popup-content{
    font-weight: bold;
    font-size: 1000px;
}

.leaflet-tooltip.my-labels {
background-color: transparent;
border: transparent;
box-shadow: none;
}
    </style>
</head>
<body>
    <!-- <div class="parent">
        <div class="header">header</div>
        <div class="container">
            <div class="left">left</div>
            <div class="righ">right</div>
        </div>
        <div class="footer">footer</div>
    </div> -->


    <!-- test -->
    <div class="container-fluid full-height" style="height:100; overflow-y: auto ; background-color: rgba(222, 229, 247, 0.163);">
        <!-- <div class="row header bg-primary"></div> -->
      <div class="row h-100" >
        <div class="col-3">
            <div class="row h-100" >
                <div class="col" style="height:570px; overflow-y: auto ; background-color: rgba(222, 229, 247, 0.163);">
                    <!-- <div class="row h-25  text-center 0-5"></div> -->
                        <div class="row  text-center mt-5">
                        <div>
                            <p>Please select Layer</p>
                            <input type="radio" id="dist" name="layer" value="district"  checked  onchange="handleClick();"><label>District</label><br>
                            <input type="radio" id="taluka" name="layer" value="taluka"  onclick="handleClick();"><label >Taluka</label><br>
                        </div>
                    </div>
                    <hr>
                    <div class="row text-center mt-5"> 
                        <div>
                            <p>Please select Census Data</p>
                            <input type="radio" id="household" name="type" value="household" checked  onchange="handleClick();"><label >Household</label><br>
                            <input type="radio" id="demography" name="type" value="demography"  onclick="handleClick();"><label >Demography</label><br>
                        </div>
                    </div>
                    <hr>

                    <!-- general sc st -->
                    <div class="row text-center mt-5"> 
                        <div>
                            <p>Please select Caste</p>
                            <input type="radio" id="general" name="caste" value="general" checked  onchange="handleClick();"><label >General</label><br>
                            <div id="sc-st">
                                <input type="radio" id="sc" name="caste" value="sc"  onclick="handleClick();"><label >SC</label><br>
                                <input type="radio" id="st" name="caste" value="st"  onclick="handleClick();"><label >ST</label><br>
                            </div>
                        </div>
                    </div>
                    <hr>

                    <!-- rural urban total -->
                    <div class="row  text-center mt-5"> 
                        <div>
                            <p>Please select Region</p>
                            <input type="radio" id="total" name="region" value="total" checked  onchange="handleClick();"><label >Total</label><br>
                            <div id = "rural-urban">
                                <input type="radio" id="rural" name="region" value="rural"  onclick="handleClick();"><label >Rural</label><br>
                                <input type="radio" id="urban" name="region" value="urban"  onclick="handleClick();"><label >Urban</label><br>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-3 text-center"> 
                        <div>
                           <button onclick="downloadShapefile();">Download Shapefile</button>
                        </div>
                    </div>
                    <hr>
                    <div class="row text-center" id="household-dropdown" > 
                        <div >
                            Select Household Census Attribute:
                            <select  onchange="handleDropdownChangeHousehold()" id="attr-dropdown-household"></select>
                        </div>
                       
                    </div>
                    <div class="row text-center" id="demography-dropdown"> 
                        <div >
                            Select Demography Census Attribute:
                            <select id="attr-dropdown-demography" onchange="handleDropdownChangeDemography()"  id="attr-dropdown-demography"></select>
                        </div>
                       
                    </div>

                    <div class="row  text-center" > 
                        <div id="show-range"> Range</div>

                        <!-- <div id="show-selected-attribute"> Selected Attribute</div> -->
                       
                    </div>


                    

                </div>
          </div>
        </div>
        <div class="col-9 bg-secondary">
          <div class='row h-100' id="map" ></div>
          
        </div>
       
      </div>
    </div>
    <!-- <p style="font-size:20px; color: rgb(58, 1, 1);" align="justify">
        <b style="margin: 1.5cm;"> In bellow, we can see the Maharashtra district and taluka level filter data integrated with the geospatial vector data format (SHP) file. 
            From the below Maharashtra district and taluka level map. 
            We can download the original data set and load them into QGIS quickly or just can download the CSV file(please click on the below given button to see the Map view).
    
        </b> 
    </p> -->
</body>
<script>
    var map; 
    map = L.map('map').setView([19.0760, 75.8777], 7);
    let activatedLayer = null;
    var tiles = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
			'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox/streets-v11',
		tileSize: 512,
		zoomOffset: -1
	}).addTo(map);

// district - household 
   let url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Households_District_Level_Census_0&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326"
   let currentData = null;
   let selectedAttribute;
   function fetchData(myurl){
    // map.spin(true,{lines: 9, length: 2, width: 20, scale: 60,radius: 70, color: "grey"});
    fetch(myurl)
        .then(response => response.json())
        .then(data => {
            console.log(selectedAttribute)
            if(typeof selectedAttribute === 'undefined')
                selectedAttribute = Object.keys(data.features[0].properties)[0] //random attribute name
                console.log(Object.keys(data.features[0].properties))

            currentData = data;
            renderLayer(data,selectedAttribute)});
    // map.spin(false);

   }

   function renderLayer(data,selectedAttribute){
    if(activatedLayer){
        map.removeLayer(activatedLayer);
        
    }

    function getRange(data){
        let range = d3.extent(data.map(d => d.properties[selectedAttribute]))
        return range
    }
    let range = getRange(data.features)
    document.getElementById("show-range").innerHTML = "Range: "+range[0] + "-" +range[1];
    // document.getElementById("show-selected-attribute").innerHTML = "Selected Attribute:" + selectedAttribute;


    var color_sequential = d3.scaleSequential(d3.interpolateGreens).domain(range);
    function style(feature) {
    let attrValue = feature.properties[selectedAttribute];
    let color;
    if(attrValue <=0 || typeof attrValue === "undefined") color = 'grey';
    else color = color_sequential(attrValue)

    return {
        fillColor:color,
        weight: 2,
        opacity: 1,
        color: 'black',
        dashArray: '3',
        fillOpacity: 0.7
    };
}

function onEachFeature(feature, layer) {

    layer.bindTooltip("<div style = 'text-transform: capitalize'>"+feature.properties[selectedAttribute]+"</div>",{permanent: true, 
   direction: "center",
   className: "my-labels"});
}


    activatedLayer =  L.geoJSON(data,{style: style,onEachFeature:onEachFeature}).addTo(map);
   }
   fetchData(url)
    function handleClick(){
        let layer = document.querySelector('input[name="layer"]:checked').value;
        let type = document.querySelector('input[name="type"]:checked').value;
        let caste = document.querySelector('input[name="caste"]:checked').value;
        let region = document.querySelector('input[name="region"]:checked').value;

        let scST = document.getElementById("sc-st");
        let ruralUrban = document.getElementById("rural-urban");

        if(layer === 'taluka' && type === 'household'){
            if(!document.getElementById('total').checked){
                document.getElementById('total').checked = true;
                handleClick() // hack
            }
            ruralUrban.style.display = "none";
        }else if(layer === 'taluka' && type === 'demography'){
            if(!document.getElementById('total').checked && !document.getElementById('general').checked){
                document.getElementById('general').checked = true;
                document.getElementById('total').checked = true;
                handleClick() // hack
            }
            scST.style.display = "none";
            ruralUrban.style.display = "none";
        }else if(layer === 'district' && type === 'demography'){
            document.getElementById('general').checked = true;
            document.getElementById('total').checked = true;
            scST.style.display = "none";
            ruralUrban.style.display = "none";
        }else if(layer === 'district' && type === 'household'){
            scST.style.display = "block";
            ruralUrban.style.display = "block";
        }

        let url = "";
        if(layer==='district' && type === 'demography' && caste === 'general' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_District_Level_Total_Demo&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'general' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Households_District_Level_Census_0&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'general' && region === 'rural') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_District_Level_Rural_Hous&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'general' && region === 'urban') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_District_Level_Urban_Hous&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        
        else if(layer==='district' && type === 'household' && caste === 'sc' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_To&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'sc' && region === 'rural') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_Ru&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'sc' && region === 'urban') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_Ur&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        
        
        else if(layer==='district' && type === 'household' && caste === 'st' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_To&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'st' && region === 'rural') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_District_Level_Ru&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='district' && type === 'household' && caste === 'st' && region === 'urban') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_District_Level_Ur&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";

        else if(layer==='taluka' && type === 'demography' && caste === 'general' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_Taluka_Level_Total_Demogr&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='taluka' && type === 'household' && caste === 'general' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharastra_Households_Taluka_Lavel_Cencus_201&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";

        else if(layer==='taluka' && type === 'household' && caste === 'sc' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_Taluka_Level_Tota&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";
        else if(layer==='taluka' && type === 'household' && caste === 'st' && region === 'total') url = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_Taluka_Level_Tota&outputFormat=json&srs=EPSG%3A4326&srsName=EPSG%3A4326";

        fetchData(url)
        toggleDropdown(type);

    }
    
    let householdDiv = document.getElementById("household-dropdown");
    let demographyDiv = element = document.getElementById("demography-dropdown");
    householdDiv.style.display = "block";
    demographyDiv.style.display = "none";
    function toggleDropdown(selectedType){

        if(selectedType === 'household') {
            householdDiv.style.display = "block";
            demographyDiv.style.display = "none";
        }
        else if(selectedType === 'demography') {
            householdDiv.style.display = "none";
            demographyDiv.style.display = "block";
        }
    }
    function downloadURI(uri, name) {
        var link = document.createElement("a");
        link.download = name;
        link.href = uri;
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        delete link;
    }

    function downloadShapefile(){
        let layer = document.querySelector('input[name="layer"]:checked').value;
        let type = document.querySelector('input[name="type"]:checked').value;
        let caste = document.querySelector('input[name="caste"]:checked').value;
        let region = document.querySelector('input[name="region"]:checked').value;

        let uri = "";
        if(layer==='district' && type === 'demography' && caste === 'general' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_District_Level_Total_Demo&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'general' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Households_District_Level_Census_0&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'general' && region === 'rural') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_District_Level_Rural_Hous&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'general' && region === 'urban') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_District_Level_Urban_Hous&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        
        
        else if(layer==='district' && type === 'household' && caste === 'sc' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_To&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'sc' && region === 'rural') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_Ru&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'sc' && region === 'urban') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_District_Level_Ur&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";

        else if(layer==='district' && type === 'household' && caste === 'st' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_District_Level_To&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'st' && region === 'rural') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_District_Level_Ru&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='district' && type === 'household' && caste === 'st' && region === 'urban') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_District_Level_Ur&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";

        else if(layer==='taluka' && type === 'demography' && caste === 'general' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_General_Taluka_Level_Total_Demogr&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='taluka' && type === 'household' && caste === 'general' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharastra_Households_Taluka_Lavel_Cencus_201&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";

        else if(layer==='taluka' && type === 'household' && caste === 'sc' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Caste_Taluka_Level_Tota&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";
        else if(layer==='taluka' && type === 'household' && caste === 'st' && region === 'total') uri = "https://gisehub.geonode.communitygis.in/geoserver/ows?service=WFS&version=1.0.0&request=GetFeature&typename=geonode%3AMaharashtra_Scheduled_Tribe_Taluka_Level_Tota&outputFormat=SHAPE-ZIP&srs=EPSG%3A4326&format_options=charset%3AUTF-8";

        downloadURI(uri, "shapefile.shp");

    }
 // populate dropdown
 let household_description =  "https://raw.githubusercontent.com/debabrata-mallick/GISE-Tool-for-Visualization-of-Census-Data/main/household.json";
 let demography_description = "https://raw.githubusercontent.com/debabrata-mallick/GISE-Tool-for-Visualization-of-Census-Data/main/demography.json";
// household
 fetch(household_description)
  .then(response => response.json())
  .then(attr_list => {
    var select = document.getElementById("attr-dropdown-household");
    attr_list.map(d =>{
        select.options[select.options.length] = new Option(d.full_description,d.short_form);
      })
  });

  function handleDropdownChangeHousehold(){
        selectedAttribute = document.getElementById("attr-dropdown-household").value;
        renderLayer(currentData,selectedAttribute)
  }


  // demography

  fetch(demography_description)
  .then(response => response.json())
  .then(attr_list => {
    var select = document.getElementById("attr-dropdown-demography");
    attr_list.map(d =>{
        select.options[select.options.length] = new Option(d.full_description,d.short_form);
      })
  });

  function handleDropdownChangeDemography(){
      
      let selectedAttribute = document.getElementById("attr-dropdown-demography").value;
        renderLayer(currentData,selectedAttribute)
  }

</script>
</html>